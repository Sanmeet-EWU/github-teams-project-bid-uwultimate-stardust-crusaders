"""Module containing CVE CVSS metric information.

https://nvd.nist.gov/developers/vulnerabilities
"""

from vulnerability_lookup.cvss._base import ABCCvss
from vulnerability_lookup.cvss.cvss_v2 import CvssV2Metrics
from vulnerability_lookup.cvss.cvss_v3 import CvssV3Metrics
from vulnerability_lookup.cvss.cvss_v31 import CvssV31Metrics


def get_metrics(metrics: object) -> ABCCvss:
    """Get updated metrics from CVE metrics data."""
    if metric := metrics.get('cvssMetricV31'):
        return CvssV31Metrics.parse_from_data(metric[0])
    elif metric := metrics.get('cvssMetricV30'):
        return CvssV3Metrics.parse_from_data(metric[0])
    elif metric := metrics.get('cvssMetricV2'):
        return CvssV2Metrics.parse_from_data(metric[0])
    raise ValueError("Failed to get metrics.")
