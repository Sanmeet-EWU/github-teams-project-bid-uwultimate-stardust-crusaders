"""Functional tests for CPE's."""

import json
import requests
from requests import Response

from vulnerability_lookup.cpe import CPE, CPEPart
from vulnerability_lookup.nvd import _NVD_API_BASE_URL


def test_cpe_api_responds(cpe: CPE):
    print(str(cpe))
    response: Response = requests.get(
        "https://services.nvd.nist.gov/rest/json/cves/2.0?virtualMatchString=cpe:2.3:o:linux:linux_kernel:*:*:*:*",
        headers={"apiKey": "4faf9c6f-eb90-4c3e-834d-2c04d686bba1"},
        timeout=1000
    )
    print(response.request.url)
    print(response.request)
    print(response.status_code)
    if response:
        print(json.dumps(response.json(), indent=4))

if __name__ == "__main__":
    test_cpe_api_responds(
        CPE(
            CPEPart.APPLICATION,
            "*",
            "OpenSSH",
            "5.3"
        )
    )
